---
title: "URL の Defang：脅威を共有するためのシンプルなセキュリティ実践"
date: 2021-05-01
lang: ja
categories: Cybersecurity
tags: [Security, Best Practices, Threat Intelligence]
excerpt: "URL の Defang は、脅威インテリジェンスを共有する際に悪意のあるリンクを誤ってクリックすることを防ぎます。セキュリティチームがこの実践を使用する理由と実装方法を学びましょう。"
comments: true
thumbnail: /assets/puzzle/thumbnail.png
---

誰もが疑わしいリンク、フィッシングメール、潜在的な詐欺に遭遇します。銀行に詐欺を報告する場合でも、IT サポートと疑わしいメールを共有する場合でも、友人にフィッシング攻撃について警告する場合でも、誤って脅威を拡散することなくこれらの脅威を伝える必要があります。悪意のあるリンクを誤ってクリックすると、デバイスやアカウントが危険にさらされる可能性があります。

セキュリティ専門家は、これらの危険な URL、IP アドレス、電子メールアドレスを「侵害の指標」（Indicators of Compromise、略して IOC）と呼びます。これは潜在的なセキュリティ脅威の証拠です。Defang は、IOC を安全に共有するためのシンプルで効果的なソリューションとして登場しました。URL を変更してクリックできないようにしながら可読性を維持することで、誰でも新しいリスクを生み出すことなく危険なリンクを共有できます。この実践は、セキュリティ専門家、IT サポートチーム、そして自分自身や他の人を保護する一般のインターネットユーザーの間で標準的な実践となっています。

## 問題：ドキュメント内のクリック可能な脅威

セキュリティドキュメントには本質的に危険なコンテンツが含まれています。インシデントレポートはフィッシング URL を参照し、マルウェア分析ドキュメントにはコマンド＆コントロールサーバーのアドレスが含まれ、脅威インテリジェンスフィードには侵害されたドメインがリストされています。これらのドキュメントが電子メール、チャット、またはコラボレーションプラットフォームを介して共有されると、URL はクリック可能なリンクになることがよくあります。

!!!warning "⚠️ クリック可能なリンクのリスク"
    **誤クリック**
    - レポートをレビューするセキュリティアナリストが誤って悪意のあるリンクをクリックする可能性がある
    - 電子メールクライアントとブラウザは URL を自動的にクリック可能にレンダリングする
    - モバイルデバイスでは誤タップが発生しやすい
    - コピー＆ペースト操作が URL プレビュー機能をトリガーする可能性がある
    
    **自動化システム**
    - セキュリティツールが URL を自動的にスキャンまたは訪問する可能性がある
    - 電子メールセキュリティゲートウェイが分析のためにリンクをフォローする可能性がある
    - コラボレーションプラットフォームがリンクプレビューを生成する可能性がある
    - バックアップシステムが URL をインデックス化して処理する可能性がある
    
    **ソーシャルエンジニアリング**
    - 攻撃者がセキュリティディスカッションとレポートを監視する
    - 悪意のある行為者がアナリストを騙して「安全」に見える IOC をクリックさせる可能性がある
    - フィッシングキャンペーンは特にセキュリティチームをターゲットにする
    - セキュリティドキュメントへの信頼が悪用される可能性がある

皮肉なことに、脅威から保護することを目的としたドキュメントが脅威ベクトル自体になる可能性があります。電子メールで共有されたマルウェア分析レポートは、受信者が分析中の URL を誤ってクリックすると感染を引き起こす可能性があります。

## Defang とは？

Defang は、URL、IP アドレス、電子メールアドレスを変更して、可読性を維持しながらクリックできないようにします。変更は、コンテンツを不明瞭にすることなく自動リンク検出を破る単純な文字置換です。

!!!anote "🔧 一般的な Defang テクニック"
    **URL Defang**
    - `.` を `[.]` に置換：`example[.]com`
    - `http` を `hxxp` に置換：`hxxp://example.com`
    - `://` を `[://]` に置換：`http[://]example.com`
    - ポートの `:` を `[:]` に置換：`example.com[:]8080`
    
    **IP アドレス Defang**
    - `.` を `[.]` に置換：`192[.]168[.]1[.]1`
    - 代替案：`192.168.1[.]1`（最後のドットのみ）
    
    **電子メールアドレス Defang**
    - `@` を `[@]` に置換：`user[@]example.com`
    - `.` を `[.]` に置換：`user@example[.]com`
    - 組み合わせ：`user[@]example[.]com`

Defang されたバージョンは人間が読みやすいままです。誰でも `hxxp://malicious[.]example[.]com` が `http://malicious.example.com` を指していることを簡単に理解できますが、電子メールクライアントとブラウザは自動的にクリック可能なリンクを作成しません。

### Refang：元の形式に戻す

これらのリンクをセキュリティツールやスクリプトで使用する必要がある場合、「refang」する必要があります。つまり、元の形式に変換します。これは通常、プログラムで行われます。

```python
def refang_url(defanged_url):
    """Defang された URL を元の形式に変換"""
    refanged = defanged_url
    refanged = refanged.replace('[.]', '.')
    refanged = refanged.replace('hxxp', 'http')
    refanged = refanged.replace('[://]', '://')
    refanged = refanged.replace('[:]', ':')
    return refanged

# 使用例
defanged = "hxxp://malicious[.]example[.]com[:]8080/path"
original = refang_url(defanged)
# 結果：http://malicious.example.com:8080/path
```

セキュリティツールと脅威インテリジェンスプラットフォームには、多くの場合、組み込みの defang および refang 機能が含まれており、アナリストのプロセスを自動化します。

## 業界の採用と標準

Defang はセキュリティ業界全体で標準的な実践となっています。主要な組織とプラットフォームがこの技術を採用しています。

!!!success "✅ 業界での使用"
    **脅威インテリジェンスプラットフォーム**
    - MISP（マルウェア情報共有プラットフォーム）が defang をサポート
    - ThreatConnect がレポート内の指標を自動的に defang
    - AlienVault OTX が脅威フィードで defang された URL を表示
    - VirusTotal のコメントで defang 形式がよく使用される
    
    **セキュリティオペレーション**
    - SOC アナリストがインシデントチケットで指標を defang
    - 脅威ハンティングレポートで defang された指標を使用
    - マルウェア分析ドキュメントで C2 サーバーを defang
    - フィッシング調査で悪意のある URL を defang
    
    **コミュニケーションチャネル**
    - セキュリティメーリングリストで defang された IOC が必要
    - Slack/Teams セキュリティチャネルで defang を使用
    - Twitter セキュリティコミュニティで defang 形式を使用
    - カンファレンスプレゼンテーションでライブデモを defang

この実践は非常に広まっているため、セキュリティ専門家は defang 形式をすぐに認識します。`hxxp` または `[.]` を見ると、明示的な警告ラベルを必要とせずに「これは悪意のある指標です」というシグナルになります。

## いつ Defang するか

すべての URL を defang する必要はありません。この実践は、潜在的に悪意のあるコンテンツを共有する際に最も価値があります。

!!!tip "🎯 Defang すべきもの"
    **悪意のある指標**
    - 電子メールキャンペーンからのフィッシング URL
    - マルウェアのダウンロード場所
    - コマンド＆コントロールサーバーのアドレス
    - 侵害された Web サイトの URL
    - エクスプロイトキットのランディングページ
    
    **疑わしいコンテンツ**
    - 調査中の URL
    - セキュリティツールによってフラグが立てられたドメイン
    - 攻撃に関連する IP アドレス
    - フィッシングに使用される電子メールアドレス
    
    **セキュリティドキュメント**
    - インシデント対応レポート
    - 脅威インテリジェンスブリーフィング
    - マルウェア分析レポート
    - セキュリティトレーニング資料
    - 脆弱性の開示

!!!anote "ℹ️ Defang すべきでないもの"
    **正当なリソース**
    - セキュリティベンダーの Web サイト
    - パッチのダウンロード場所
    - ドキュメントの参照
    - ツールのダウンロードリンク
    - 教育リソース
    
    **コンテキストが重要**
    - 内部セキュリティツール（すでに制御された環境内）
    - セキュリティツールによって消費される自動フィード
    - 次のステップで即座に refang が必要な状況

重要な質問は次のとおりです。誰かが誤ってこれをクリックして害を引き起こす可能性がありますか？はいの場合は、defang してください。

## ワークフローに Defang を実装する

セキュリティワークフローに defang を統合するには、技術ツールとプロセスの変更の両方が必要です。

!!!anote "🔧 実装アプローチ"
    **手動 Defang**
    - 1 回限りの共有のための迅速な編集
    - ドキュメント内で文字を手動で置換
    - 少数のリンクに便利
    - 不整合とエラーが発生しやすい
    
    **ブラウザ拡張機能**
    - 選択したテキストをワンクリックで defang
    - URL をコピーする際に自動的に defang
    - チーム全体で一貫したフォーマット
    
    **コマンドラインツール**
    - リンクリストのバッチ処理
    - セキュリティスクリプトとの統合
    - パイプラインでの自動 defang
    
    **セキュリティプラットフォーム統合**
    - チケットシステムでの自動 defang
    - 脅威インテリジェンスプラットフォームに組み込まれた defang
    - オンデマンドで refang できる defang 表示

迅速な defang のニーズに対応するため、シンプルな Web ベースのツールを作成しました：[Defang ツール](/ja/tools/defang/)。URL、IP、電子メールアドレスをカスタマイズ可能な defang オプションで処理します。このツールは完全にブラウザ内で動作し、データをサーバーに送信しないため、機密性の高い IOC に対して安全です。

### Defang された URL のユーザーエクスペリエンスの向上

Defang は誤クリックを防ぎますが、正当な使用に摩擦を生じさせる可能性があります。スマートな実装は、安全性と使いやすさのバランスを取ります。

!!!tip "🎯 UX ベストプラクティス"
    **ワンクリック Refang**
    - Defang された URL の横に「元をコピー」ボタンを提供
    - クリックすると自動的に refang してクリップボードにコピー
    - 元のリンクが必要なアナリストの手動編集を削減
    - 例：`hxxp://example[.]com` → クリック → `http://example.com` がコピーされる
    
    **視覚的インジケーター**
    - Defang されたコンテンツに独特のスタイルを使用（等幅フォント、異なる色）
    - 「defang」ステータスを示すアイコンまたはバッジを追加
    - URL が意図的に変更されたことを明確にする
    - 「壊れた」リンクについての混乱を防ぐ
    
    **ホバーツールチップ**
    - ホバー時にクリック可能にせずに元の URL を表示
    - 「クリックして元をコピー」の指示を表示
    - ドキュメントを必要とせずにコンテキストを提供
    
    **選択的 Defang**
    - ユーザーが defang とオリジナルビューを切り替えられるようにする
    - 制御された環境（SOC ワークステーション）で便利
    - 認証または明示的なユーザーアクションが必要
    - 安全性を維持しながら柔軟性を提供
    
    **コンテキスト対応表示**
    - 電子メールとパブリックチャネルではデフォルトで defang
    - サンドボックス分析環境では元を表示
    - ユーザーの役割と環境のセキュリティに基づいて適応
    
    **スキャン後 Defang**
    - URL をスキャンサービス（VirusTotal、URLScan.io）に送信
    - スキャン完了後に自動的に defang
    - Defang された URL にスキャン結果リンクを含める
    - 共有前に安全性の検証を提供
    - 例：「hxxp://example[.]com（VirusTotal：5/89 検出）」

[Defang ツール](/ja/tools/defang/)は、これらのパターンのいくつかを実装しています。カスタマイズ可能な defang オプションで適用する変換を選択でき、ワンクリックコピーボタンで出力を簡単に使用できます。ツールは設定を記憶し、繰り返しの defang タスクを効率化します。

### チームプロセスの考慮事項

ツール以外にも、成功する defang にはチームの連携が必要です。

!!!success "✅ プロセスのベストプラクティス"
    **標準を確立**
    - 使用する defang 形式を文書化
    - defang が必要な時期を指定
    - 一般的なシナリオのテンプレートを作成
    - チームメンバーにこの実践をトレーニング
    
    **ワークフローに統合**
    - インシデント対応手順に defang ステップを追加
    - レポートテンプレートに defang を含める
    - チケットシステムを設定して defang を促す
    - 共有コンテンツを適切な defang のためにレビュー
    
    **セキュリティと使いやすさのバランス**
    - 内部ツールの URL を defang しない
    - 必要なアナリストに簡単な refang を提供
    - defang を決定する際にコンテキストを考慮
    - 正当なコンテンツの過度な defang を避ける

目標は、セキュリティオペレーションに摩擦を追加するのではなく、defang を自動的かつ簡単にすることです。

## 制限と考慮事項

Defang は完全なセキュリティソリューションではありません。誤クリックを防ぎますが、制限があります。

!!!warning "⚠️ Defang が防げないもの"
    **意図的な行動**
    - アナリストは手動で refang して URL にアクセスできる
    - Defang は意図的なアクセスを防がない
    - 適切なセキュリティコントロールの代替にはならない
    
    **高度な攻撃**
    - 攻撃者はフィッシングに defang された URL を含めることができる
    - ソーシャルエンジニアリングでユーザーを騙して refang させることができる
    - Defang は URL の安全性を検証しない
    
    **ツールの互換性**
    - 一部のセキュリティツールは標準 URL 形式を期待する
    - 自動処理には refang が必要な場合がある
    - 外部システムとの統合が壊れる可能性がある

Defang は多層防御の 1 つの層です。サンドボックス分析環境、ネットワークセグメンテーション、セキュリティ意識向上トレーニングなどの他のセキュリティ対策を補完するものであり、置き換えるものではありません。

### 人的要因

Defang の有効性は人間の行動に依存します。

!!!tip "🎯 人的考慮事項"
    **トレーニングが必要**
    - 新しいチームメンバーはこの実践を学ぶ必要がある
    - なぜ defang が重要かを説明
    - 適切な defang テクニックを実演
    - 必要に応じて refang する方法を示す
    
    **一貫性が重要**
    - 一貫性のない defang は混乱を招く
    - 混合形式は有効性を低下させる
    - チーム全体での採用が重要
    
    **誤った安全性を作らない**
    - Defang は URL を安全に訪問できるようにしない
    - アナリストには依然として適切なセキュリティコントロールが必要
    - 分析にはサンドボックス環境が依然として必要
    - Defang は便利さであり、保護ではない

セキュリティチーム全体が理解し、一貫して適用する場合に、この実践は最も効果的です。

## URL を超えて：その他の Defang アプリケーション

URL が最も一般的なユースケースですが、defang は他の指標にも適用されます。

!!!anote "📋 その他の Defang 可能なコンテンツ"
    **ファイルパス**
    - マルウェアの場所：`C[:]\\Windows\\System32\\malware.exe`
    - ネットワーク共有：`\\\\server[.]domain[.]com\\share`
    
    **レジストリキー**
    - `HKEY_LOCAL_MACHINE\\Software\\Malware`（すでにクリック不可）
    - ドキュメントの一貫性のために便利
    
    **コマンド文字列**
    - URL を含む PowerShell コマンド
    - 悪意のあるエンドポイントを含む Curl/wget コマンド
    - IOC を含むスクリプト
    
    **暗号通貨アドレス**
    - ランサムウェアで使用されるビットコインアドレス
    - 詐欺のイーサリアムアドレス
    - クリップボードへの誤コピーを防ぐ

原則は同じです。潜在的に危険なコンテンツを読みやすさを維持しながら非対話的にします。

## 結論

URL の Defang は、脅威インテリジェンスとインシデント対応の標準となったシンプルで効果的なセキュリティ実践を表しています。URL、IP アドレス、電子メールアドレスを変更して自動リンク作成を防ぐことで、セキュリティチームは新しいリスクを生み出すことなく侵害の指標を安全に共有できます。

この実践は実際のニーズから生まれました。セキュリティドキュメントには、明確かつ安全に伝達する必要がある危険なコンテンツが含まれています。インシデントレポート内の悪意のあるリンクの誤クリック、脅威フィード内の URL をフォローする自動化システム、セキュリティチームをターゲットとするソーシャルエンジニアリング攻撃は、すべて defang が重要である理由を示しています。

実装は簡単です。一般的な技術には、ドットを `[.]` に置き換える、`http` を `hxxp` に変更する、プロトコルセパレーターを括弧で囲むことが含まれます。これらの変更は、人間の可読性を維持しながら自動リンク検出を破ります。IOC をセキュリティツールで使用する必要がある場合、簡単に refang できます。つまり、元の形式に変換できます。

業界での採用は広範囲に及んでいます。脅威インテリジェンスプラットフォーム、セキュリティオペレーションセンター、セキュリティコミュニケーションチャネルは、通常 defang 形式を使用します。この実践は非常に一般的になっているため、セキュリティ専門家は `hxxp://malicious[.]example[.]com` を defang された悪意のある指標としてすぐに認識します。

ただし、defang には制限があります。誤クリックを防ぎますが、意図的な行動を止めず、URL の安全性を検証せず、ツールの互換性のために refang が必要になる場合があります。この実践は、サンドボックス分析環境やセキュリティ意識向上トレーニングなどの他のセキュリティ対策を補完するものであり、置き換えるものではありません。

成功する defang には、技術ツールとプロセスの変更の両方が必要です。手動編集、ブラウザ拡張機能、コマンドラインツール、統合されたセキュリティプラットフォームのいずれを使用する場合でも、重要なのは defang を自動的かつ簡単にすることです。チーム全体での採用、一貫したフォーマット、明確な標準により、この実践が最大の利益を提供することが保証されます。

迅速な defang のニーズには、[Defang ツール](/ja/tools/defang/)をお試しください。これは、カスタマイズ可能なオプションで URL、IP、電子メールアドレスを処理するブラウザベースのユーティリティです。完全にクライアント側で動作するため、機密性の高い指標に対して安全です。

Defang はすべてのセキュリティインシデントを防ぐわけではありませんが、一般的で簡単に防げるリスクを排除します。それは、セキュリティドキュメント内の悪意のあるリンクの誤クリックです。危険なコンテンツを常に扱う業界では、このシンプルな実践は貴重な安全マージンを提供します。脅威インテリジェンスを共有したり、インシデントを文書化したり、悪意のある指標について議論したりする際には、時間をかけて defang してください。あなたの同僚とセキュリティ態勢の両方が恩恵を受けるでしょう。
